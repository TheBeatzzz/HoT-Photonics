<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Optics of Sight: An Interactive Presentation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutrals -->
    <!-- Application Structure Plan: A narrative, single-page scrolling application with a sticky navigation bar. The flow follows the presentation plan: Hook (Illusion) -> Core Concepts (How We See) -> Problem/Solution (Defects & Fixes) -> Climax (OCT Research). This structure turns the lecture into an explorable story, making it more engaging for a young, international audience than a linear slide deck. Key interactions include revealing the illusion's truth, hovering over diagrams for information, and manipulating a color mixer, which fosters hands-on learning. -->
    <!-- Visualization & Content Choices: 
        - Checker Shadow Illusion: Goal: Hook/Engage. Method: HTML/CSS Grid + JS toggle. Interaction: Button click to reveal the truth. Justification: A high-impact, memorable start that immediately establishes the theme.
        - Eye vs. Camera: Goal: Compare/Inform. Method: HTML/CSS Flexbox diagram. Interaction: Hover to highlight corresponding parts. Justification: Uses a familiar analogy to explain complex anatomy simply.
        - Color Perception: Goal: Engage/Inform. Method: Chart.js Doughnut chart + HTML sliders. Interaction: Sliders control a color swatch and the chart data. Justification: Active participation is more effective than passive observation for learning how colors are mixed.
        - Eye Defects: Goal: Inform/Compare. Method: HTML/CSS/Canvas diagrams. Interaction: Buttons to toggle between defect view and corrected view. Justification: Animation clearly visualizes an abstract physics concept.
        - OCT Research: Goal: Inspire/Inform. Method: High-quality image with text overlay + HTML/CSS animated diagram. Interaction: Button to trigger a simplified "How it Works" animation. Justification: Creates a "wow" factor with the real scan and makes the complex technology understandable through analogy.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF8;
            color: #4B4B4B;
        }
        .nav-active {
            color: #D97706;
            font-weight: 600;
        }
        .checkerboard {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            width: 100%;
            max-width: 400px;
            aspect-ratio: 1 / 1;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .checkerboard-square {
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
        }
        .light { background-color: #D1D5DB; }
        .dark { background-color: #6B7280; }
        .cylinder-shadow {
            position: absolute;
            top: 5%;
            left: 50%;
            width: 20%;
            height: 90%;
            background: rgba(0, 0, 0, 0.25);
            transform: translateX(-50%) skewX(-20deg);
            filter: blur(15px);
            transition: opacity 0.5s ease-in-out;
        }
        .truth .cylinder-shadow { opacity: 0; }
        .truth .square-a, .truth .square-b {
            background-color: #9CA3AF !important;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            height: 250px;
            max-height: 300px;
        }
        .chart-container2 {
            position: relative;
            width: 100%;
            height: 40vh;
            max-height: 450px;
            background: rgba(0,0,0,0.8);
            border-radius: 0.5rem;
            padding: 1rem;
        }
        .section-container {
            border-radius: 1rem;
            background-color: rgba(47, 60, 80, 0.8);
            border: 1px solid #334155;
            padding: 2rem;
            margin-bottom: 4rem;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 300px;
                max-height: 350px;
            }
        }
        .diagram-highlight {
            transition: all 0.2s ease-in-out;
            border-radius: 0.5rem;
        }
        .diagram-highlight:hover {
            background-color: rgba(217, 119, 6, 0.1);
            transform: scale(1.05);
        }
                .card {
            font-family: 'Merriweather', serif;
            width: 100px;
            height: 140px;
            background-color: white;
            border-radius: 8px;
            border: 1px solid #ddd;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2), 0 0 20px rgba(255, 255, 255, 0.1) inset;
            position: relative;
            cursor: default;
            transition: transform 0.2s ease-out, box-shadow 0.2s ease-out;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 8px;
            font-size: 1.5rem;
            font-weight: 700;
        }
        .card:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3), 0 0 30px rgba(255, 255, 255, 0.2) inset;
        }
        .card.red { color: #c81e1e; }
        .card.black { color: #222; }
        .card-rank-top { align-self: flex-start; }
        .card-suit-center {
            font-size: 3rem;
            text-align: center;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .card-rank-bottom { align-self: flex-end; transform: rotate(180deg); }
        .spotlight {
            background: radial-gradient(circle, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0) 70%);
        }
        .font-mono {
            font-family: 'Space Mono', monospace;
        }
        .spectrum-bar {
            transition: all 0.2s ease-in-out;
        }
        .spectrum-bar:hover {
            transform: scale(1.05);
            z-index: 10;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
        }
        .molecule-btn.active {
            transform: scale(1.1);
            box-shadow: 0 0 15px var(--glow-color);
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-50 shadow-sm">
        <center>
        <br>
        <h1 class="text-4xl md:text-6xl font-bold text-blue-700 mb-4">Optics of Human Vision and Perception</h1>
        </center>
        <nav class="container mx-auto px-6 py-3 flex justify-between items-center">
            <div class="font-bold text-lg text-gray-800">
                <span style="color:magenta;">Asian Science Camp 2025, August 2, 2025</span>
            </div>
            <div class="hidden md:flex space-x-8">
                <a href="#illusion" class="nav-link text-gray-600 hover:text-amber-600">The Illusion</a>
                <a href="#how-we-see" class="nav-link text-gray-600 hover:text-amber-600">How We See</a>
                <a href="#when-sight-fails" class="nav-link text-gray-600 hover:text-amber-600">When Sight Fails</a>
                <a href="#future" class="nav-link text-gray-600 hover:text-amber-600">Retina Diagnostics</a>
            </div>
        </nav>
    </header>

    <main>
        <br><br><br>
        <center>
            <h3 class="text-3xl text-gray-800 mb-4 ">An Interactive Dialogue with </h3> <br>
            <h2 class="text-3xl text-gray-800 max-w-3xl mb-4 mx-auto font-bold">Associate Professor Dr. Panomsak Meemon</h2><br>
            <h3 class="text-3xl text-gray-800 mb-4 font-bold">Asian Science Camp 2025</h3>
            <h3 class="text-3xl text-gray-800 mb-4 ">Suranaree University of Technology, Nakhon Ratchasima, Thailand</h3>
            <h3 class="text-2xl text-gray-800 mb-4 ">Date: August 2, 2025</h3>
        </center>
        <br><br><br><br>
        <!-- Introduction Section -->
        <section id="illusion" class="min-h-screen flex flex-col items-center justify-center text-center px-6 py-12 bg-gray-50">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-4">Can You Trust Your Eyes?</h1>
            <p class="text-3xl md:text-3xl text-gray-600 max-w-3xl mx-auto mb-8">Let's begin with a simple question. 
                <br>Look at the checkerboard below. 
                <br> Which square is darker: <span class="font-bold">A</span> or <span class="font-bold">B</span>?
            </p>

            <div id="illusion-wrapper" class="relative flex justify-center items-center mb-8" style="width: 320px; height: 320px;">
                <div class="checkerboard" id="checkerboard"></div>
                <div class="cylinder-shadow"></div>
            </div>

            <button id="reveal-btn" class="bg-amber-600 text-white font-bold py-5 px-10 rounded-full hover:bg-amber-700 transition-transform transform hover:scale-105 shadow-lg">Reveal the Truth</button>
            <p id="reveal-text" class="text-3xl text-gray-600 max-w-3xl mx-auto mt-6 opacity-0 transition-opacity duration-500">They are the exact same color. Surprised? You're not just seeing with your eyes; your brain is a powerful co-processor that interprets context, like shadows. Today, we'll explore this incredible partnership.</p>
        </section>
        <div id="trick-container" class="text-center w-full max-w-4xl mx-auto">
        
        <!-- Digital Mind Reading -->
        <!-- Step 1: Initial Instructions -->
        <div id="step1">
            <h1 class="text-4xl md:text-5xl font-bold font-serif mb-4" style="font-family: 'Merriweather', serif;">The Digital Mind Reader</h1>
            <p class="text-3xl md:text-3xl text-white-300 mb-8">First, pick any card from the set below. 
                <br>Don't tell anyone, just keep it in your mind.</p>
            <div id="card-grid-1" class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-4 md:gap-6 mb-8 justify-center">
                <!-- Cards for step 1 will be generated here -->
            </div>
            <button id="next-step-btn" class="bg-indigo-600 text-white font-bold py-3 px-8 rounded-full hover:bg-indigo-500 transition-all transform hover:scale-105 shadow-lg text-lg">
                Got it. Read my mind!
            </button>
        </div>

        <!-- Step 2: The Reveal -->
        <div id="step2" class="hidden">
            <h2 class="text-3xl md:text-4xl font-bold font-serif mb-4" style="font-family: 'Merriweather', serif;">Concentrate...</h2>
            <p class="text-lg md:text-xl text-black-300 mb-8">You were thinking of a card, and now... 
                <br><br>Poof! Look closely. I have removed your chosen card from the set.
            </p>
            <div id="card-grid-2" class="grid grid-cols-3 sm:grid-cols-5 gap-4 md:gap-6 mb-8 justify-center">
                <!-- Cards for step 2 will be generated here -->
            </div>
            <button id="reveal-secret-btn" class="bg-amber-600 text-white font-bold py-2 px-6 rounded-full hover:bg-amber-500 transition-all transform hover:scale-105 shadow-md">How did you do that?</button>
        </div>

        <!-- The Secret Explanation -->
        <div id="secret" class="hidden mt-12 p-6 bg-black bg-opacity-100 rounded-lg max-w-2xl mx-auto border border-gray-600">
            <h3 class="text-2xl font-bold font-serif mb-4 text-amber-400" style="font-family: 'Merriweather', serif;">The Secret: It's All in Your Head</h3>
            <p class="text-gray-300">This isn't magic, it's psychology! Your brain is excellent at focusing on one thing (picking a card) but not so good at memorizing an entire random set. When I showed you the second group of cards, you looked for your card and saw it was missing.</p>
            <p class="text-gray-300 mt-4">The trick? <strong class="text-amber-400">Every single card in the second set is different from the first.</strong> Your card was "gone" simply because the entire original set was replaced!</p>
            <p class="text-gray-300 mt-4">This is a form of <strong class="text-amber-400">'Change Blindness,'</strong> a fascinating topic in perception science. It proves we don't see everything we think we see. Our brain takes shortcuts to manage information.</p>
            <button id="reset-btn" class="mt-6 bg-gray-500 text-white font-bold py-2 px-6 rounded-full hover:bg-gray-400 transition-all">Try Again</button>
        </div>
    </div>
<script>
document.addEventListener('DOMContentLoaded', () => {
    const suits = {
        '♠': 'black', '♣': 'black',
        '♥': 'red', '♦': 'red'
    };
    const ranks = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];

    const cardGrid1 = document.getElementById('card-grid-1');
    const cardGrid2 = document.getElementById('card-grid-2');
    const step1Div = document.getElementById('step1');
    const step2Div = document.getElementById('step2');
    const secretDiv = document.getElementById('secret');
    
    const nextStepBtn = document.getElementById('next-step-btn');
    const revealSecretBtn = document.getElementById('reveal-secret-btn');
    const resetBtn = document.getElementById('reset-btn');

    let initialCards = [];
    let revealCards = [];

    function createCardElement(rank, suit) {
        const card = document.createElement('div');
        const color = suits[suit];
        card.className = `card ${color}`;
        
        card.innerHTML = `
            <div class="card-rank-top">${rank}</div>
            <div class="card-suit-center">${suit}</div>
            <div class="card-rank-bottom">${rank}</div>
        `;
        return card;
    }

    function generateUniqueCards(count, excludeList = []) {
        const cards = new Set();
        const excludeSet = new Set(excludeList.map(c => `${c.rank}-${c.suit}`));

        while (cards.size < count) {
            const rank = ranks[Math.floor(Math.random() * ranks.length)];
            const suit = Object.keys(suits)[Math.floor(Math.random() * Object.keys(suits).length)];
            const cardKey = `${rank}-${suit}`;
            
            if (!excludeSet.has(cardKey)) {
                cards.add(cardKey);
            }
        }
        
        return Array.from(cards).map(key => {
            const [rank, suit] = key.split('-');
            return { rank, suit };
        });
    }

    function populateGrid(gridElement, cardData) {
        gridElement.innerHTML = '';
        cardData.forEach(card => {
            const cardEl = createCardElement(card.rank, card.suit);
            gridElement.appendChild(cardEl);
        });
    }

    function setupTrick() {
        step1Div.classList.remove('hidden');
        step2Div.classList.add('hidden');
        secretDiv.classList.add('hidden');

        initialCards = generateUniqueCards(6);
        revealCards = generateUniqueCards(5, initialCards);

        populateGrid(cardGrid1, initialCards);
        populateGrid(cardGrid2, revealCards);
    }

    nextStepBtn.addEventListener('click', () => {
        step1Div.classList.add('hidden');
        step2Div.classList.remove('hidden');
    });

    revealSecretBtn.addEventListener('click', () => {
        secretDiv.classList.remove('hidden');
    });

    resetBtn.addEventListener('click', () => {
        setupTrick();
    });

    // Initial setup
    setupTrick();
});
</script>
<br><br><br><br><br><br><br><br>
        <!-- How We See Section -->
        <section id="how-we-see" class="py-20 px-6 container mx-auto">
            <h2 class="text-3xl md:text-5xl font-bold text-center text-gray-800 mb-4">The Eye: An Advanced Optical Camera</h2>
            <p class="text-2xl text-center text-gray-600 max-w-3xl mx-auto mb-16">
                To understand how we see, it helps to compare the eye to a device we all know: a camera. 
                <br>Both capture light to form an image, but the eye's biological components are far more sophisticated. 
                <br>
                <br>This section explores how light becomes sight, 
                <br>from the initial focus to the final processing in the brain.
            </p>

            <div class="grid md:grid-cols-2 gap-12 items-center mb-20">
                <div class="p-6 bg-white rounded-xl shadow-md">
                    <h3 class="text-3xl font-bold text-center mb-4">The Human Eye</h3>
                    <div class="space-y-4 text-lg">
                        <p class="diagram-highlight p-2" data-pair="lens">
                            <strong>Cornea & Lens:</strong> The primary focusing elements that bend light.
                        </p>
                        <p class="diagram-highlight p-2" data-pair="aperture">
                            <strong>Iris & Pupil:</strong> Control the amount of light entering, just like a camera's aperture.
                        </p>
                        <p class="diagram-highlight p-2" data-pair="sensor">
                            <strong>Retina:</strong> A light-sensitive layer at the back of the eye that acts as the biological "sensor."
                        </p>
                    </div>
                </div>
                <div class="p-6 bg-white rounded-xl shadow-md">
                    <h3 class="text-3xl font-bold text-center mb-4">A Digital Camera</h3>
                     <div class="space-y-4 text-lg">
                        <p class="diagram-highlight p-2" data-pair="lens">
                            <strong>Lens Assembly:</strong> A series of glass elements that focus light.
                        </p>
                        <p class="diagram-highlight p-2" data-pair="aperture">
                            <strong>Aperture:</strong> A mechanical opening that controls light exposure.
                        </p>
                        <p class="diagram-highlight p-2" data-pair="sensor">
                            <strong>Image Sensor (CMOS/CCD):</strong> A silicon chip that converts light into electrical signals.
                        </p>
                    </div>
                </div>
            </div>
            <br><br><br><br><br><br><br>
             <div class="text-center mb-20">
                <h3 class="text-3xl font-bold text-gray-800 mb-4">The Journey of a Light Ray</h3>
                <p class="text-2xl text-gray-600 max-w-2xl mx-auto mb-6">
                    The cornea performs most of the initial light bending, 
                    <br>with the lens making fine adjustments to focus the image perfectly onto the retina.
                </p>
                <canvas id="light-path-canvas" class="w-full max-w-2xl mx-auto bg-white rounded-lg shadow-md" height="200"></canvas>
            </div>

            <br><br><br><br><br><br><br>
            <div class="bg-white rounded-xl shadow-lg p-8 md:p-12">
                <h3 class="text-3xl font-bold text-center text-gray-800 mb-4">The Sensor and the Processor</h3>
                <p class="text-2xl text-center text-gray-600 max-w-3xl mx-auto mb-12">The retina is packed with 126 million photoreceptors. The 'cones' are responsible for color vision. We only have three types—Red, Green, and Blue—but our brain mixes their signals to create every color you've ever seen. Let's see it in action.</p>
                
                <div class="grid md:grid-cols-2 gap-12 items-center">
                    <div>
                        <div class="chart-container">
                            <canvas id="color-chart"></canvas>
                        </div>
                    </div>
                    <div class="space-y-6">
                        <div id="color-swatch" class="w-full h-24 rounded-lg shadow-inner transition-colors duration-200" style="background-color: rgb(128, 128, 128);"></div>
                        <div>
                            <label for="red-slider" class="font-semibold">Red</label>
                            <input id="red-slider" type="range" min="0" max="255" value="128" class="w-full">
                        </div>
                        <div>
                            <label for="green-slider" class="font-semibold">Green</label>
                            <input id="green-slider" type="range" min="0" max="255" value="128" class="w-full">
                        </div>
                        <div>
                            <label for="blue-slider" class="font-semibold">Blue</label>
                            <input id="blue-slider" type="range" min="0" max="255" value="128" class="w-full">
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <br><br><br><br><br><br><br>

        <!--Earth's EM Shield: Atmospheric Absorption
        <!-- Section 1: Introduction -->
        <section id="intro" class="text-center mb-24">
            <h1 class="text-4xl md:text-4xl font-bold text-Red mb-4 font-mono">Earth's Protective Shield</h1>
            <p class="text-2xl md:text-xl text-black-400 max-w-3xl mx-auto">The universe is flooded with energy in a vast spectrum of wavelengths, far beyond what our eyes can see. But here on the surface, we're protected. Our atmosphere acts as a selective filter, allowing life-giving light to pass while blocking most of the harmful radiation. This is the story of that shield.</p>
        </section>

        <!-- Section 2: The EM Spectrum -->
        <section id="spectrum" class="mb-24">
            <h2 class="text-3xl font-bold text-red text-center mb-2">The Cosmic Rainbow</h2>
            <p class="text-2xl text-black-400 text-center mb-8 max-w-2xl mx-auto">This is the full electromagnetic spectrum. Visible light is just a tiny sliver. Hover over each section to see an example.</p>
            <div class="flex flex-col md:flex-row w-full rounded-lg overflow-hidden border border-gray-700">
                <div class="spectrum-bar group relative flex-1 p-4 text-center" style="background-color: #7c3aed;">
                    <span class="font-bold">Radio</span>
                    <div class="absolute bottom-full mb-2 w-full left-0 opacity-0 group-hover:opacity-100 transition-opacity"><span class="bg-black text-white text-xs rounded py-1 px-2">AM/FM, Wi-Fi</span></div>
                </div>
                <div class="spectrum-bar group relative flex-1 p-4 text-center" style="background-color: #db2777;">
                    <span class="font-bold">Microwave</span>
                     <div class="absolute bottom-full mb-2 w-full left-0 opacity-0 group-hover:opacity-100 transition-opacity"><span class="bg-black text-white text-xs rounded py-1 px-2">Cooking, Radar</span></div>
                </div>
                <div class="spectrum-bar group relative flex-1 p-4 text-center" style="background-color: #e11d48;">
                    <span class="font-bold">Infrared</span>
                     <div class="absolute bottom-full mb-2 w-full left-0 opacity-0 group-hover:opacity-100 transition-opacity"><span class="bg-black text-white text-xs rounded py-1 px-2">Heat, Night Vision</span></div>
                </div>
                <div class="spectrum-bar group relative flex-grow-0 p-4 text-center" style="background: linear-gradient(to right, #ef4444, #f97316, #eab308, #84cc16, #22c55e, #14b8a6, #06b6d4, #3b82f6, #8b5cf6);">
                    <span class="font-bold text-black">Visible</span>
                     <div class="absolute bottom-full mb-2 w-full left-0 opacity-0 group-hover:opacity-100 transition-opacity"><span class="bg-black text-white text-xs rounded py-1 px-2">Sunlight, Rainbows</span></div>
                </div>
                <div class="spectrum-bar group relative flex-1 p-4 text-center" style="background-color: #a855f7;">
                    <span class="font-bold">Ultraviolet</span>
                     <div class="absolute bottom-full mb-2 w-full left-0 opacity-0 group-hover:opacity-100 transition-opacity"><span class="bg-black text-white text-xs rounded py-1 px-2">Sunburns, Blacklights</span></div>
                </div>
                <div class="spectrum-bar group relative flex-1 p-4 text-center" style="background-color: #6366f1;">
                    <span class="font-bold">X-Ray</span>
                     <div class="absolute bottom-full mb-2 w-full left-0 opacity-0 group-hover:opacity-100 transition-opacity"><span class="bg-black text-white text-xs rounded py-1 px-2">Medical Imaging</span></div>
                </div>
                <div class="spectrum-bar group relative flex-1 p-4 text-center" style="background-color: #888bF1;">
                    <span class="font-bold">Gamma Ray</span>
                     <div class="absolute bottom-full mb-2 w-full left-0 opacity-0 group-hover:opacity-100 transition-opacity"><span class="bg-black text-white text-xs rounded py-1 px-2">Nuclear Reactions</span></div>
                </div>
            </div>
        </section>

        <!-- Section 3: The Great Filter -->
        <section id="filter" class="mb-24">
            <h2 class="text-3xl font-bold text-red text-center mb-2">The Great Filter</h2>
            <p class="text-2xl text-black-400 text-center mb-8 max-w-3xl mx-auto">This chart shows how "opaque" our atmosphere is to different wavelengths. A high percentage means the radiation is blocked. Notice the two main "windows" where energy can pass through freely: the Optical Window and the Radio Window.</p>
            <div class="chart-container2">
                <canvas id="absorptionChart"></canvas>
            </div>
        </section>

        <!-- Section 4: Meet the Absorbers -->
        <section id="absorbers" class="mb-24">
            <h2 class="text-3xl font-bold text-red text-center mb-2">Meet the Absorbers</h2>
            <p class="text-2xl text-black-400 text-center mb-8 max-w-3xl mx-auto">This filtering isn't magic. It's the result of specific gas molecules in the atmosphere absorbing energy at specific wavelengths. Click on the molecules below to see their individual absorption patterns on the chart above.</p>
            <div class="flex justify-center items-center flex-wrap gap-4">
                <button class="molecule-btn p-4 border-2 rounded-lg transition-all duration-200" data-molecule="o2o3" style="--glow-color: #3b82f6; border-color: #3b82f6;">
                    <span class="text-2xl font-bold">O₂ & O₃</span>
                    <span class="block text-sm">Oxygen & Ozone</span>
                </button>
                <button class="molecule-btn p-4 border-2 rounded-lg transition-all duration-200" data-molecule="h2o" style="--glow-color: #06b6d4; border-color: #06b6d4;">
                    <span class="text-2xl font-bold">H₂O</span>
                    <span class="block text-sm">Water Vapour</span>
                </button>
                <button class="molecule-btn p-4 border-2 rounded-lg transition-all duration-200" data-molecule="co2" style="--glow-color: #eab308; border-color: #eab308;">
                    <span class="text-2xl font-bold">CO₂</span>
                    <span class="block text-sm">Carbon Dioxide</span>
                </button>
            </div>
        </section>
        
        <!-- Section 5: Why it Matters -->
        <section id="implications" class="bg-gray-900/80 p-8 rounded-lg border border-gray-700">
            <h2 class="text-3xl font-bold text-white text-center mb-6">Why This Shield Matters</h2>
            <div class="grid md:grid-cols-3 gap-8 text-center">
                <div>
                    <h3 class="text-2xl font-bold text-cyan-400 mb-2">Life is Possible</h3>
                    <p class="text-xl text-gray-300">The ozone layer's absorption of nearly all harmful Ultraviolet (UV) radiation prevents severe damage to DNA in living organisms. Without it, life on the surface would be impossible.</p>
                </div>
                <div>
                    <h3 class="text-2xl font-bold text-amber-400 mb-2">A Window to the Stars</h3>
                    <p class="text-xl text-gray-300">The "Optical Window" allows visible light to reach us, enabling us to see the world and astronomers to study the cosmos with ground-based telescopes. The "Radio Window" opened up the field of radio astronomy.</p>
                </div>
                <div>
                    <h3 class="text-2xl font-bold text-green-400 mb-2">The Greenhouse Effect</h3>
                    <p class="text-xl text-gray-300">The absorption of Infrared (heat) radiation by water vapour and CO₂ is crucial for keeping our planet warm. This natural greenhouse effect is vital, but its enhancement is the cause of modern climate change concerns.</p>
                </div>
            </div>
        </section>
  <script>
document.addEventListener('DOMContentLoaded', () => {
    const ctx = document.getElementById('absorptionChart').getContext('2d');
    
    // Labels representing the EM spectrum visually, not to scale.
    const labels = [
        'Radio', ' ', 'Microwave', ' ', 'Infrared', ' ', 'Visible', ' ', 'UV', ' ', 'X-Ray', ' ', 'Gamma'
    ];
    
    // Y-axis is opacity (0% to 100%)
    const totalAbsorptionData = [
        0, 5, 80, 70, 99, 95, 5, 20, 100, 100, 100, 100, 100
    ];

    const moleculeData = {
        o2o3: {
            label: 'O₂ & O₃ Absorption',
            data: [0, 0, 0, 0, 0, 0, 0, 15, 90, 100, 95, 50, 20],
            borderColor: '#3b82f6',
            backgroundColor: 'rgba(59, 130, 246, 0.3)',
            hidden: true
        },
        h2o: {
            label: 'H₂O Absorption',
            data: [0, 0, 70, 60, 98, 80, 0, 0, 0, 0, 0, 0, 0],
            borderColor: '#06b6d4',
            backgroundColor: 'rgba(6, 182, 212, 0.3)',
            hidden: true
        },
        co2: {
            label: 'CO₂ Absorption',
            data: [0, 0, 0, 0, 80, 50, 0, 0, 0, 0, 0, 0, 0],
            borderColor: '#eab308',
            backgroundColor: 'rgba(234, 179, 8, 0.3)',
            hidden: true
        }
    };

    const chartData = {
        labels: labels,
        datasets: [
            {
                label: 'Total Atmospheric Opacity',
                data: totalAbsorptionData,
                fill: true,
                backgroundColor: 'rgba(201, 209, 217, 0.2)',
                borderColor: '#c9d1d9',
                tension: 0.4,
                pointRadius: 0
            },
            moleculeData.o2o3,
            moleculeData.h2o,
            moleculeData.co2
        ]
    };

    const absorptionChart = new Chart(ctx, {
        type: 'line',
        data: chartData,
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: {
                    beginAtZero: true,
                    max: 100,
                    ticks: {
                        callback: function(value) {
                            return value + '%'
                        },
                        color: '#8b949e'
                    },
                    grid: {
                        color: 'rgba(139, 148, 158, 0.2)'
                    },
                    title: {
                        display: true,
                        text: 'Opacity (Blocked Radiation)',
                        color: '#c9d1d9'
                    }
                },
                x: {
                    ticks: {
                        color: '#8b949e'
                    },
                    grid: {
                        display: false
                    },
                    title: {
                        display: true,
                        text: 'Electromagnetic Spectrum (Conceptual)',
                        color: '#c9d1d9'
                    }
                }
            },
            plugins: {
                legend: {
                    display: true,
                    position: 'bottom',
                    labels: {
                        color: '#c9d1d9'
                    }
                },
                tooltip: {
                    mode: 'index',
                    intersect: false,
                }
            },
            interaction: {
                mode: 'index',
                intersect: false
            }
        }
    });

    const moleculeBtns = document.querySelectorAll('.molecule-btn');
    moleculeBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            const molecule = btn.dataset.molecule;
            const datasetIndex = absorptionChart.data.datasets.findIndex(d => d.label === moleculeData[molecule].label);
            
            if (datasetIndex !== -1) {
                const isHidden = absorptionChart.isDatasetVisible(datasetIndex);
                absorptionChart.setDatasetVisibility(datasetIndex, !isHidden);
                btn.classList.toggle('active', !isHidden);
                absorptionChart.update();
            }
        });
    });
});
</script>
        <br><br>
        <!-- Why the Sky is Blue -->
         <section id="atmosphere" class="section-container">
            <div class="grid md:grid-cols-2 gap-8 items-center">
                <div>
                    <h3 class="text-2xl font-semibold text-cyan-300 mb-2">Why the Sky is Blue</h3>
                    <p class="text-xl text-gray-300 mb-4">Sunlight contains all colors, but our atmosphere is better at scattering short-wavelength blue light in all directions. 
                        This scattered blue light comes to our eyes from all over the sky.</p>
                    <h3 class="text-2xl font-semibold text-orange-300 mb-2">Why Sunsets are Red</h3>
                    <p class="text-xl text-gray-300 mb-4">At sunset, light travels through more atmosphere. 
                        So much blue light is scattered away that only the longer-wavelength red and orange light remains to reach our eyes.</p>
                </div>
                <div id="sky-color-sim" class="h-64 bg-slate-900 rounded-lg p-4 relative overflow-hidden cursor-pointer">
                    <div id="sky-sun" class="absolute w-16 h-16 bg-yellow-300 rounded-full transition-all duration-1000" style="top: 20%; left: 45%;"></div>
                    <div id="sky-atmosphere" class="absolute inset-0 transition-all duration-1000" style="background: linear-gradient(to bottom, #87ceeb, #add8e6);"></div>
                    <p class="absolute bottom-4 left-4 text-white font-bold text-lg z-10" id="sky-time-label">Midday (Click to change)</p>
                </div>
            </div>
        </section>
<script>
        // --- Sky Color Simulation ---
    const skySim = document.getElementById('sky-color-sim');
    const skySun = document.getElementById('sky-sun');
    const skyAtmosphere = document.getElementById('sky-atmosphere');
    const skyTimeLabel = document.getElementById('sky-time-label');
    skySim.addEventListener('click', () => {
        const isSunset = skySun.style.top === '65%';
        if (isSunset) {
            skySun.style.top = '20%';
            skySun.style.left = '45%';
            skySun.style.backgroundColor = '#ffeb3b';
            skyAtmosphere.style.background = 'linear-gradient(to bottom, #87ceeb, #add8e6)';
            skyTimeLabel.textContent = 'Midday (Click to change)';
        } else {
            skySun.style.top = '65%';
            skySun.style.left = '5%';
            skySun.style.backgroundColor = '#f97316';
            skyAtmosphere.style.background = 'linear-gradient(to bottom, #4c51bf, #f56565, #f6e05e)';
            skyTimeLabel.textContent = 'Sunset (Click to change)';
        }
    });
</script>

        <br><br><br><br><br><br><br>
        <!-- When Sight Fails Section -->
        <section id="when-sight-fails" class="py-20 px-6 bg-gray-50">
            <div class="container mx-auto">
                <h2 class="text-3xl md:text-5xl font-bold text-center text-gray-800 mb-4">When the System Needs a Tune-Up</h2>
                <p class="text-2xl text-center text-black-600 max-w-3xl mx-auto mb-16">Sometimes, the eye's optical system isn't perfectly calibrated. 
                    If the focal point doesn't land precisely on the retina, the world becomes blurry. 
                    This section explains common refractive errors and how simple optics can correct them, 
                    bringing the world back into sharp focus.</p>
                <div class="bg-white rounded-xl shadow-lg p-8 md:p-12">
                    <div class="grid md:grid-cols-2 gap-8 items-center">
                        <div class="text-center">
                            <h3 class="text-3xl font-bold text-red-600 mb-4">A Blurry World</h3>
                            <p class="text-2xl text-red-600 mb-6">Myopia (nearsightedness) occurs when the eye focuses images in front of the retina. Hyperopia (farsightedness) occurs when it focuses behind. Click the buttons to see how this happens and how we fix it.</p>
                             <div class="flex justify-center space-x-4 mb-6">
                                <button id="myopia-btn" class="defect-btn bg-amber-600 text-white font-semibold py-2 px-4 rounded-full">Myopia</button>
                                <button id="hyperopia-btn" class="defect-btn bg-gray-300 text-gray-700 font-semibold py-2 px-4 rounded-full">Hyperopia</button>
                            </div>
                            <button id="fix-btn" class="bg-green-600 text-white font-bold py-2 px-6 rounded-full hover:bg-green-700 transition-transform transform hover:scale-105">Show Fix</button>
                        </div>
                        <div>
                           <canvas id="defect-canvas" class="w-full max-w-md mx-auto" height="250"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="future" class="py-20 px-6">
            <div class="container mx-auto">
                <h2 class="text-3xl md:text-5xl font-bold text-center text-gray-800 mb-4">The Future of Sight: Seeing the Unseen</h2>
                <p class="text-2xl text-center text-gray-600 max-w-3xl mx-auto mb-16">
                    Correcting focus is one challenge, but what about diseases that 
                    <span style="color: #dc2626; font-weight: bold;">damage the retina</span> itself? 
                    In my lab, we develop advanced imaging technologies like 
                    <span style="color: #3e26dc; font-weight: bold;">Optical Coherence Tomography (OCT)</span> 
                    to non-invasively see tissues and cells underneath the retina surface in unprecedented detail. 
                    This allows us to diagnose diseases early and pave the way for a future where blindness is preventable.</p>
                
                <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                    <div class="relative">
                        <img src="https://file.notion.so/f/f/0d32a4fe-51c5-43ec-a771-855902a54267/7fe8574c-2562-4e6e-bb03-7d3b56ee0378/1ac158cf-00b2-4ffe-b0b5-699cff2f34cb.png?table=block&id=867df51b-23a5-4c72-a523-e901e1c9012d&spaceId=0d32a4fe-51c5-43ec-a771-855902a54267&expirationTimestamp=1754092800000&signature=ALnWVKbm8YnkxwR99c80-NdmJaylzvJ5uGFxo-mKes0&downloadName=Untitled.png" alt="High-resolution OCT scan of a retina" class="w-full h-auto object-cover">
                        <div class="absolute inset-0 bg-black/50 flex items-center justify-center">
                            <div class="text-center text-white p-8">
                                <h3 class="text-4xl font-bold mb-4">Optical Coherence Tomography (OCT)</h3>
                                <p class="text-xl max-w-2xl">A non-invasive technology that provides cross-sectional images of the retina, layer by layer.</p>
                            </div>
                        </div>
                    </div>
                    <br><br>
                    <section id="oct-principle-section" class="section-container" style="max-width: 700px; margin: 0 auto;">
                        <div class="p-8 md:p-12 text-center">
                        <h2 class="text-5xl font-bold text-yellow-600 mb-4">How does it work?</h2>
                        <p class="text-4xl text-yellow-500 max-w-2xl mx-auto mb-6">
                            Think of it like using 'light echoes' to build a picture. 
                            We send light into the eye, and by measuring the tiny delays 
                            in its return from different retinal layers, we can construct a detailed 3D map.</p>
                    </section>
                    <img src="https://file.notion.so/f/f/0d32a4fe-51c5-43ec-a771-855902a54267/6094126e-e02b-48c1-b71f-b9ea96854300/08db2599-1ac0-4870-b713-5938cf272fba.png?table=block&id=04599a11-abb6-4c14-a1d2-638ac9fb23f4&spaceId=0d32a4fe-51c5-43ec-a771-855902a54267&expirationTimestamp=1754092800000&signature=yiSCHKYNZ8HW4AU2w2K-J4ihNlk8Sr-gM6JZR2aOAUI&downloadName=Untitled.png" alt="OCT principle" class="w-3/5 h-auto object-cover mx-auto my-6 block">
                    </div><br><br>
                    <section id="oct-wrapping-section" class="section-container" style="max-width: 700px; margin: 0 auto;">
                        <h2 class="text-4xl text-green-300 max-w-2xl mx-auto mb-6 text-center">
                        This technology is revolutionizing how we diagnose and treat retinal diseases, offering hope for millions.</h2>
                    </section>
                    <img src="https://file.notion.so/f/f/0d32a4fe-51c5-43ec-a771-855902a54267/ddd64c6b-ddba-4af5-8e1e-4967be06600d/image.png?table=block&id=183ed553-42d7-80b8-8ab0-eb8712c4206c&spaceId=0d32a4fe-51c5-43ec-a771-855902a54267&expirationTimestamp=1754049600000&signature=HjtRKvTX4prkfEF_w5lAjO1aeA5OGP4YiytWNWoBjh0&downloadName=image.png" alt="LASER lab SUT" class="w-3/4 h-auto object-cover mx-auto my-6 block">
                <br><br>
                <center>
                    <p class="text-3xl max-w-2xl mx-auto mb-6">
                        <span style="color: #1c1cc2; font-weight: bold;">
                        This is my lab at Suranaree University of Technology, 
                        where we develop these advanced imaging technologies.
                        </span>
                    </p>
                    <img src="https://file.notion.so/f/f/0d32a4fe-51c5-43ec-a771-855902a54267/473e2744-71e1-4679-b1a2-fa50f6f4007e/Untitled.png?table=block&id=add8e62f-ab09-44e7-b84f-cb342978d230&spaceId=0d32a4fe-51c5-43ec-a771-855902a54267&expirationTimestamp=1754100000000&signature=8zXoQ3W75dAK331UjDm0kZLZIvqcMxlwkVpFYX74WII&downloadName=Untitled.png" alt="My lab at SUT" class="w-3/5 h-auto object-cover mx-auto rounded-lg shadow-md">
                </center>         
                </div>
            </div>
        </section>
        
        <footer class="bg-gray-800 text-white py-12 px-6">
            <div class="container mx-auto text-center">
                <h2 class="text-3xl font-bold mb-4">The Journey Continues</h2>
                <p class="text-2xl max-w-2xl mx-auto mb-6">The most exciting discoveries in science are yet to be made—perhaps by one of you. Thank you for joining this dialogue.</p>
                <p class="font-semibold">Assoc. Prof. Dr. Panomsak Meemon</p>
                <p>Suranaree University of Technology</p>
                <a href="mailto:panomsak@sut.ac.th" class="text-amber-400 hover:text-amber-300">panomsak@sut.ac.th</a>
            </div>
            <img src="https://i.ibb.co/nsKCVjK6/Optics-Human-Vision.png" alt="QR" border="0" class="w-1/5 h-auto object-cover mx-auto rounded-lg shadow-md">
        </footer>
    </main>

<script>
document.addEventListener('DOMContentLoaded', () => {

    function initCheckerboard() {
        const board = document.getElementById('checkerboard');
        const revealBtn = document.getElementById('reveal-btn');
        const revealText = document.getElementById('reveal-text');
        const illusionWrapper = document.getElementById('illusion-wrapper');
        let revealed = false;

        for (let i = 0; i < 64; i++) {
            const square = document.createElement('div');
            square.classList.add('checkerboard-square');
            const row = Math.floor(i / 8);
            const col = i % 8;
            if ((row + col) % 2 === 0) {
                square.classList.add('light');
            } else {
                square.classList.add('dark');
            }
            if (row === 1 && col === 2) {
                square.textContent = 'A';
                square.classList.add('square-a');
            }
            if (row === 4 && col === 4) {
                square.textContent = 'B';
                square.classList.add('square-b');
            }
            board.appendChild(square);
        }

        revealBtn.addEventListener('click', () => {
            revealed = !revealed;
            illusionWrapper.classList.toggle('truth', revealed);
            revealText.style.opacity = revealed ? '1' : '0';
            revealBtn.textContent = revealed ? 'Hide the Truth' : 'Reveal the Truth';
        });
    }

    function initNavigation() {
        const navLinks = document.querySelectorAll('.nav-link');
        const sections = document.querySelectorAll('main section');

        const observerOptions = {
            root: null,
            rootMargin: '0px',
            threshold: 0.5,
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    navLinks.forEach(link => {
                        link.classList.remove('nav-active');
                        if (link.getAttribute('href').substring(1) === entry.target.id) {
                            link.classList.add('nav-active');
                        }
                    });
                }
            });
        }, observerOptions);

        sections.forEach(section => {
            observer.observe(section);
        });
    }
    
    function initEyeCameraDiagram() {
        const highlights = document.querySelectorAll('.diagram-highlight');
        highlights.forEach(el => {
            el.addEventListener('mouseenter', () => {
                const pair = el.dataset.pair;
                document.querySelectorAll(`[data-pair="${pair}"]`).forEach(p => {
                    p.style.backgroundColor = 'rgba(217, 119, 6, 0.1)';
                });
            });
            el.addEventListener('mouseleave', () => {
                document.querySelectorAll(`[data-pair]`).forEach(p => {
                    p.style.backgroundColor = 'transparent';
                });
            });
        });
    }

    function initLightPathCanvas() {
        const canvas = document.getElementById('light-path-canvas');
        const ctx = canvas.getContext('2d');
        let width = canvas.clientWidth;
        let height = canvas.clientHeight;
        canvas.width = width;
        canvas.height = height;
        let progress = 0;

        function drawEye() {
            ctx.clearRect(0, 0, width, height);
            
            ctx.strokeStyle = '#4B4B4B';
            ctx.lineWidth = 3;

            const eyeRadius = height * 0.4;
            const eyeCenterY = height / 2;
            const eyeCenterX = width - eyeRadius -50;
            
             // Draw the eye outline
            ctx.beginPath();
            ctx.arc(eyeCenterX, eyeCenterY, eyeRadius, Math.PI * 1.3, Math.PI * 0.7);
            ctx.stroke();

             // Draw the cornea
            const corneaRadius = eyeRadius * 0.8;
            const corneaCenterX = eyeCenterX - eyeRadius + corneaRadius * 0.8;
            ctx.beginPath();
            ctx.arc(corneaCenterX + eyeRadius * 0.0, eyeCenterY, corneaRadius, Math.PI * 0.7, Math.PI * 1.3);
            ctx.stroke();

            // Draw the front of eye lens
            const F_LensRadius = eyeRadius * 0.7;
            const F_LensCenterX = eyeCenterX - eyeRadius + corneaRadius * 0.7;
            ctx.beginPath();
            ctx.arc(F_LensCenterX + eyeRadius * 0.35, eyeCenterY, corneaRadius, Math.PI * 0.75, Math.PI * 1.25);
            ctx.stroke();

            // Draw the back of eye lens
            const B_LensRadius = eyeRadius * 0.7;
            const B_LensCenterX = eyeCenterX - eyeRadius - corneaRadius * 0.7;
            ctx.beginPath();
            ctx.arc(B_LensCenterX + eyeRadius * 0.35, eyeCenterY, corneaRadius, - Math.PI * 0.25, Math.PI * 0.25);
            ctx.stroke();
            
            // Draw the focal point
            ctx.fillStyle = '#D97706';
            ctx.beginPath();
            const focalPointX = eyeCenterX - eyeRadius * Math.cos(Math.PI);
            ctx.arc(focalPointX, eyeCenterY, 5, 0, 2 * Math.PI);
            ctx.fill();
            ctx.font = '12px Inter';
            ctx.fillStyle = '#4B4B4B';
            ctx.fillText('Retina (Focal Point)', focalPointX - 100, eyeCenterY + 30);
        }

        function animateLight() {
            drawEye();
            
            const startX = 0;
            const corneaPointX = width - 2 * 0.4 * height - 0.2 * 1.2 * 0.4 * height;
            const focalPointX = width - 0.1 * height;

            const yPoints = [height * 0.3, height * 0.7];

            ctx.strokeStyle = 'rgba(255, 220, 0, 0.8)';
            ctx.lineWidth = 4;

            yPoints.forEach(startY => {
                const endX = startX + progress * (focalPointX - startX);
                
                ctx.beginPath();
                ctx.moveTo(startX, startY);

                if (endX < corneaPointX) {
                    ctx.lineTo(endX, startY);
                } else {
                    ctx.lineTo(corneaPointX, startY);
                    const slope = (height / 2 - startY) / (focalPointX - corneaPointX);
                    const currentX = endX;
                    const currentY = startY + (currentX - corneaPointX) * slope;
                    ctx.lineTo(currentX, currentY);
                }
                ctx.stroke();
            });

            progress += 0.01;
            if (progress > 1) {
                progress = 0;
            }
            requestAnimationFrame(animateLight);
        }
        animateLight();
    }

    let colorChart;
    function initColorMixer() {
        const ctx = document.getElementById('color-chart').getContext('2d');
        const rSlider = document.getElementById('red-slider');
        const gSlider = document.getElementById('green-slider');
        const bSlider = document.getElementById('blue-slider');
        const swatch = document.getElementById('color-swatch');

        const chartData = {
            labels: ['Red', 'Green', 'Blue'],
            datasets: [{
                label: 'Color Contribution',
                data: [128, 128, 128],
                backgroundColor: ['#EF4444', '#22C55E', '#3B82F6'],
                borderColor: '#FDFBF8',
                borderWidth: 4,
            }]
        };

        colorChart = new Chart(ctx, {
            type: 'doughnut',
            data: chartData,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                    },
                    tooltip: {
                        enabled: false
                    }
                },
                cutout: '60%'
            }
        });

        function updateColor() {
            const r = rSlider.value;
            const g = gSlider.value;
            const b = bSlider.value;
            swatch.style.backgroundColor = `rgb(${r}, ${g}, ${b})`;
            colorChart.data.datasets[0].data = [r, g, b];
            colorChart.update();
        }

        rSlider.addEventListener('input', updateColor);
        gSlider.addEventListener('input', updateColor);
        bSlider.addEventListener('input', updateColor);
    }

    let defectState = 'myopia';
    let showFix = false;
    function initDefectDiagram() {
        const canvas = document.getElementById('defect-canvas');
        const ctx = canvas.getContext('2d');
        const myopiaBtn = document.getElementById('myopia-btn');
        const hyperopiaBtn = document.getElementById('hyperopia-btn');
        const fixBtn = document.getElementById('fix-btn');
        const defectBtns = document.querySelectorAll('.defect-btn');

        function draw() {
            const width = canvas.clientWidth;
            const height = canvas.clientHeight;
            canvas.width = width;
            canvas.height = height;
            
            ctx.clearRect(0, 0, width, height);

            const eyeRadius = height * 0.4;
            const eyeCenterY = height / 2;
            const eyeCenterX = width * 0.50;

            // Draw the eye outline
            ctx.strokeStyle = '#4B4B4B';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(eyeCenterX, eyeCenterY, eyeRadius, Math.PI * 1.3, Math.PI * 0.7);
            ctx.stroke();
            
            // Draw the cornea
            const corneaRadius = eyeRadius * 0.8;
            const corneaCenterX = eyeCenterX - eyeRadius + corneaRadius * 0.8;
            ctx.beginPath();
            ctx.arc(corneaCenterX, eyeCenterY, corneaRadius, Math.PI * 0.7, Math.PI * 1.3);
            ctx.stroke();

            // Draw the front of eye lens
            const F_LensRadius = eyeRadius * 0.7;
            const F_LensCenterX = eyeCenterX - eyeRadius + corneaRadius * 0.7;
            ctx.beginPath();
            ctx.arc(F_LensCenterX + eyeRadius * 0.35, eyeCenterY, corneaRadius, Math.PI * 0.75, Math.PI * 1.25);
            ctx.stroke();

            // Draw the back of eye lens
            const B_LensRadius = eyeRadius * 0.7;
            const B_LensCenterX = eyeCenterX - eyeRadius - corneaRadius * 0.7;
            ctx.beginPath();
            ctx.arc(B_LensCenterX + eyeRadius * 0.35, eyeCenterY, corneaRadius, - Math.PI * 0.25, Math.PI * 0.25);
            ctx.stroke();

            let focalX;
            if (defectState === 'myopia') {
                focalX = eyeCenterX + eyeRadius * 0.8;
            } else { // hyperopia
                focalX = eyeCenterX + eyeRadius * 1.2;
            }
            
            if (showFix) {
                focalX = eyeCenterX + eyeRadius;
                ctx.strokeStyle = '#3B82F6';
                ctx.lineWidth = 3;
                ctx.beginPath();
                if (defectState === 'myopia') { // Concave lens
                    ctx.moveTo(width * 0.05, height * 0.2);
                    ctx.quadraticCurveTo(width * 0.10, height / 2, width * 0.05, height * 0.8);
                } else { // Convex lens
                    ctx.moveTo(width * 0.2, height * 0.2);
                    ctx.quadraticCurveTo(width * -0.1, height / 2, width * 0.2, height * 0.8);
                }
                ctx.stroke();
            }

            ctx.strokeStyle = 'rgba(255, 220, 0, 0.8)';
            ctx.lineWidth = 1.5;
            const yPoints = [height * 0.3, height * 0.7];
            yPoints.forEach(y => {
                ctx.beginPath();
                ctx.moveTo(0, y);
                const corneaX = corneaCenterX - Math.sqrt(corneaRadius**2 - (y - eyeCenterY)**2);
                ctx.lineTo(corneaX, y);
                ctx.lineTo(focalX, eyeCenterY);
                ctx.stroke();
            });
        }

        myopiaBtn.addEventListener('click', () => {
            defectState = 'myopia';
            showFix = false;
            defectBtns.forEach(b => b.classList.remove('bg-amber-600', 'text-white'));
            myopiaBtn.classList.add('bg-amber-600', 'text-white');
            hyperopiaBtn.classList.remove('bg-amber-600', 'text-white');
            hyperopiaBtn.classList.add('bg-gray-300', 'text-gray-700');
            draw();
        });

        hyperopiaBtn.addEventListener('click', () => {
            defectState = 'hyperopia';
            showFix = false;
            defectBtns.forEach(b => b.classList.remove('bg-amber-600', 'text-white'));
            hyperopiaBtn.classList.add('bg-amber-600', 'text-white');
            myopiaBtn.classList.remove('bg-amber-600', 'text-white');
            myopiaBtn.classList.add('bg-gray-300', 'text-gray-700');
            draw();
        });

        fixBtn.addEventListener('click', () => {
            showFix = !showFix;
            draw();
        });
        
        draw();
        window.addEventListener('resize', draw);
    }

    function initOctAnimation() {
        const btn = document.getElementById('oct-animation-btn');
        const container = document.getElementById('oct-animation-container');
        const canvas = document.getElementById('oct-canvas');
        const ctx = canvas.getContext('2d');
        let animationFrameId;

        btn.addEventListener('click', () => {
            if (container.classList.contains('hidden')) {
                container.classList.remove('hidden');
                btn.textContent = 'Hide Animation';
                startAnimation();
            } else {
                container.classList.add('hidden');
                btn.textContent = 'See Simplified Animation';
                cancelAnimationFrame(animationFrameId);
            }
        });

        function startAnimation() {
            let progress = 0;
            const width = canvas.clientWidth;
            const height = canvas.clientHeight;
            canvas.width = width;
            canvas.height = height;

            const layers = [
                { y: height * 0.4, color: '#A5B4FC', thickness: 10 },
                { y: height * 0.5, color: '#7DD3FC', thickness: 15 },
                { y: height * 0.65, color: '#67E8F9', thickness: 20 },
            ];

            function animate() {
                ctx.clearRect(0, 0, width, height);

                // Draw layers
                layers.forEach(layer => {
                    ctx.fillStyle = layer.color;
                    ctx.fillRect(width * 0.4, layer.y, width * 0.6, layer.thickness);
                });
                
                // Draw light source
                const sourceX = width * 0.1;
                const sourceY = height / 2;
                ctx.fillStyle = '#FBBF24';
                ctx.beginPath();
                ctx.arc(sourceX, sourceY, 10, 0, 2 * Math.PI);
                ctx.fill();

                // Animate light pulse
                const pulseX = sourceX + progress * (width * 0.9 - sourceX);
                
                ctx.strokeStyle = '#FBBF24';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(sourceX, sourceY);
                ctx.lineTo(pulseX, sourceY);
                ctx.stroke();

                // Draw echoes
                layers.forEach((layer, index) => {
                    const layerX = width * 0.4;
                    if (pulseX > layerX) {
                        const echoProgress = (pulseX - layerX) / (width * 0.9 - layerX);
                        const echoX = layerX - echoProgress * (layerX - sourceX);
                        ctx.globalAlpha = 1 - echoProgress;
                        ctx.strokeStyle = layer.color;
                        ctx.beginPath();
                        ctx.moveTo(layerX, sourceY);
                        ctx.lineTo(echoX, sourceY);
                        ctx.stroke();
                        ctx.globalAlpha = 1;
                    }
                });

                progress += 0.005;
                if (progress > 1) progress = 0;

                animationFrameId = requestAnimationFrame(animate);
            }
            animate();
        }
    }

    initCheckerboard();
    initNavigation();
    initEyeCameraDiagram();
    initLightPathCanvas();
    initColorMixer();
    initDefectDiagram();
    initOctAnimation();
});
</script>

</body>
</html>
